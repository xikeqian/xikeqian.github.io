(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-albumsDetail-albumsDetail"],{"05fd":function(t,e,i){"use strict";i.r(e);var a=i("4e01"),o=i.n(a);for(var l in a)"default"!==l&&function(t){i.d(e,t,(function(){return a[t]}))}(l);e["default"]=o.a},"0699":function(t,e,i){var a=i("40b0");"string"===typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);var o=i("4f06").default;o("366123d8",a,!0,{sourceMap:!1,shadowMode:!1})},"0bd3":function(t,e,i){"use strict";var a;i.d(e,"b",(function(){return o})),i.d(e,"c",(function(){return l})),i.d(e,"a",(function(){return a}));var o=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-uni-view",{staticClass:"main"},[i("v-uni-view",{staticClass:"perInfo"},[i("v-uni-view",{staticClass:"timeAndInfo"},[i("v-uni-view",{staticStyle:{flex:"1"}},[i("v-uni-text",{staticStyle:{"font-weight":"bold"}},[t._v(t._s(t.galleryTime))])],1),i("v-uni-view",{staticClass:"uInfo"},[i("v-uni-image",{attrs:{src:t.albumInfo.icon_photo_url}}),i("v-uni-text",{staticStyle:{"line-height":"40rpx"}},[t._v(t._s(t.albumInfo.nick_name))])],1)],1),i("v-uni-view",[i("v-uni-text",{staticStyle:{color:"#666666"}},[t._v(t._s(t.albumInfo.name))])],1)],1),i("v-uni-view",{staticClass:"panel-photo"},[i("album-detail",{ref:"albumDetail",attrs:{"gallery-id":t.gallery_id,"is-all-selected":t.isAllSelected,params:t.params,jurisdiction:t.jurisdiction}})],1)],1)},l=[]},"40b0":function(t,e,i){var a=i("24fb");e=a(!1),e.push([t.i,".albumCover[data-v-9287ddb4]{height:%?60?%;width:%?60?%}.confirmMove[data-v-9287ddb4]{width:%?300?%;height:%?90?%;margin:%?60?% auto;background:-webkit-linear-gradient(right,#fa4545,#ff6614);background:linear-gradient(270deg,#fa4545,#ff6614);border-radius:45px;color:#fff;text-align:center;line-height:%?90?%}.closeMovePanel[data-v-9287ddb4]{width:%?28?%;height:%?28?%}.movePanel[data-v-9287ddb4]{position:fixed;z-index:10;bottom:%?0?%;width:%?750?%;height:%?1100?%;padding:%?32?%;background-color:#fff;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;flex-direction:column}.photoArea .videoEmpty[data-v-9287ddb4]{width:%?300?%;height:%?400?%;position:absolute;top:0;left:0;bottom:0;right:0;margin:auto}.normal[data-v-9287ddb4]{background-color:#f2f2f2}.checked[data-v-9287ddb4]{background-color:#fff3f0}.singleAlbum[data-v-9287ddb4]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;flex-direction:row}.main[data-v-9287ddb4]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;flex-direction:column}.lebalFilter[data-v-9287ddb4]{-webkit-box-flex:2;-webkit-flex:2;flex:2;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;flex-direction:row;-webkit-box-pack:end;-webkit-justify-content:flex-end;justify-content:flex-end}.lebalFilter uni-image[data-v-9287ddb4]{width:%?36?%;height:%?36?%}.lebalFilter uni-text[data-v-9287ddb4]{margin-left:%?8?%;line-height:%?36?%}.uInfo[data-v-9287ddb4]{-webkit-box-flex:1;-webkit-flex:1;flex:1;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;flex-direction:row;-webkit-box-pack:end;-webkit-justify-content:flex-end;justify-content:flex-end}.uInfo uni-image[data-v-9287ddb4]{width:%?40?%;height:%?40?%;border-radius:50%;margin-right:%?12?%}.timeAndInfo[data-v-9287ddb4]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;flex-direction:row;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between}.bottomTab[data-v-9287ddb4]{display:-webkit-box;display:-webkit-flex;display:flex;position:fixed;bottom:%?-2?%;width:%?750?%;height:%?96?%;background:hsla(0,0%,100%,.9);z-index:1}.nav[data-v-9287ddb4]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center;\n\t/* flex-direction: row; */\n\t/* padding: 24rpx 24rpx; */height:%?88?%;\n\t/* height: 44px; */padding-top:0;box-sizing:initial;font-size:%?34?%;color:#333;background-color:#fff;position:-webkit-sticky;position:sticky;top:0;left:0;z-index:1000}.nav-return[data-v-9287ddb4]{width:%?35?%;height:%?35?%;\n\t/* position: fixed; */z-index:1}.titlecheck[data-v-9287ddb4]{color:#ff4e28}.bottomTab .items[data-v-9287ddb4]{height:%?96?%;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-flex:1;-webkit-flex:1;flex:1;text-align:center;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;flex-direction:column}.header[data-v-9287ddb4]{width:%?750?%;height:%?88?%;background:#fff;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;flex-direction:row}.header uni-image[data-v-9287ddb4]{margin-top:%?24?%}.perInfo[data-v-9287ddb4]{position:-webkit-sticky;position:sticky;top:%?0?%;width:%?750?%;height:%?156?%;background:#fff;padding:%?24?%;border-bottom:%?1?% solid #e5e5e5;z-index:1}\n\n/* .selectTitle {\n\tdisplay: flex;\n\tflex-direction: row;\n\twidth: 750rpx;\n\theight: 100rpx;\n\tbackground: rgba(255, 255, 255, 1);\n\tpadding: 30rpx 24rpx;\n} */.normalText[data-v-9287ddb4]{-webkit-box-flex:1;-webkit-flex:1;flex:1;text-align:center;color:#ff4e28}.PointText[data-v-9287ddb4]{-webkit-box-flex:3;-webkit-flex:3;flex:3;text-align:center;color:#333;font-family:PingFangSC-Semibold,PingFang SC;font-weight:600}.photoArea[data-v-9287ddb4]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;flex-direction:row;-webkit-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-pack:start;-webkit-justify-content:start;justify-content:start;width:%?750?%;height:%?960?%;-webkit-align-content:start;align-content:start}.photoArea .imgs[data-v-9287ddb4]{width:%?183?%;height:%?183?%;margin-right:%?5?%;position:relative}.header_img[data-v-9287ddb4]{width:%?40?%;height:%?40?%;margin:0 %?20?%}.items uni-image[data-v-9287ddb4]{width:%?48?%;height:%?48?%}.photoArea uni-image[data-v-9287ddb4]{width:%?183?%;height:%?183?%}.photoArea uni-video[data-v-9287ddb4]{width:%?183?%;height:%?183?%}.labelPanel[data-v-9287ddb4]{z-index:99;position:fixed;top:%?350?%;left:0;height:%?985?%;right:0;padding-left:%?300?%}.labelPanel .bg[data-v-9287ddb4]{margin:auto;position:absolute;left:0;top:0;right:0;bottom:0;background-color:rgba(0,0,0,.6);z-index:-1}.labelPanel .labels[data-v-9287ddb4]{width:60%;padding:%?40?%;overflow:auto;background-color:#fff;overflow:auto;position:absolute;right:0;top:0;bottom:%?100?%;border-top:%?2?% solid #eee}.labelPanel uni-text[data-v-9287ddb4]{display:inline-block;padding:%?8?% %?20?%;width:-webkit-fit-content;width:fit-content;height:-webkit-fit-content;height:fit-content;margin-bottom:%?32?%;margin-right:%?40?%}.tabbarIcons[data-v-9287ddb4]{display:inline-block;height:%?48?%;width:%?48?%;margin:0 auto}.labelPanel .btn[data-v-9287ddb4]{border-top:%?1?% solid #ff4e28;height:%?100?%;text-align:center;color:#ff4e28;font-size:%?32?%;line-height:%?100?%;background-color:#fff;position:absolute;bottom:0;right:0;width:60%}.photoArea .imgs .video-play[data-v-9287ddb4]{position:absolute;left:50%;top:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%);width:%?64?%;height:%?64?%}.u-select-box[data-v-9287ddb4]{margin:auto;position:absolute;left:0;top:0;right:0;bottom:0}.u-select-box uni-image[data-v-9287ddb4]{position:absolute;top:%?15?%;right:%?15?%;width:%?44?%;height:%?44?%}.panel-photo[data-v-9287ddb4]{\n\t/* height: calc(100% - 100px); */}",""]),t.exports=e},"4e01":function(t,e,i){"use strict";var a=i("4ea4");i("99af"),i("a623"),i("4de4"),i("7db0"),i("4160"),i("d81d"),i("ac1f"),i("5319"),i("159b"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=a(i("ade3")),l=i("325c"),s=a(i("e8ce")),n=a(i("e398")),r=a(i("1e79")),d={components:{videoPlay:n.default,previewImage:s.default,albumDetail:r.default},filters:{format:function(t){return l.dateUtils.format(t)}},data:function(){return{filtersrc:"../../static/albumsDetail/filter.png",empty_status:!1,mediaStatus:"PHOTO",mediaArr:[{id:1,title:"图片",checked:!0},{id:2,title:"视频",checked:!1}],tabbars:[{id:1,src:"https://common.xxpie.com/blockAdd.png",title:"添加到"},{id:2,src:"https://common.xxpie.com/blackAIPhotoshop.png",title:"AI修图"},{id:3,src:"../../static/albumsDetail/share_1.png",title:"分享"},{id:4,src:"../../static/albumsDetail/label.png",title:"标签"},{id:5,src:"../../static/albumsDetail/more.png",title:"更多"}],status_1:1,selected_numbers:0,photos:[],videos:[],selectShow:!1,SelectionStatus:!1,selectionColor:"black",labelShow:!1,albumInfo:{},userInfo:{},tagsPage:1,gallery_id:"",userLebals:[],pageNo:1,pageSize:50,tag_def_ids:"",filter_start_time:"",filter_end_time:"",galleryTime:"",jurisdiction:!1,fileName:"",fileUrl:"",ossobjectId:"",tags:[],iscollect:0,isAllSelected:!1,oddGalleryId:"",selectAllFlag:!1,movePanel:!1,allAlbums:[],operateImages:[],albumCount:{video:0,photo:0},countPhoto:0,countVideo:0,params:{},queryState:!0}},onLoad:function(t){this.gallery_id=t.gallery_id,this.galleryTime=t.time;var e=t.time.replace(/-/g,"/");e+=" 00:00:00",this.filter_start_time=new Date(e).getTime(),console.log("!!!!!!!!!!!!!!!!!!!!!"),console.log(this.filter_start_time),this.filter_end_time=this.filter_start_time+864e5,this.params={filter_start_time:this.filter_start_time,filter_end_time:this.filter_end_time,upload_by:t.upload_by}},onShow:function(){this.$refs.albumDetail&&this.$refs.albumDetail.cancelSelectedAll(),this.$refs.albumDetail&&this.$refs.albumDetail.getUserLabels()},mounted:function(){var t=this;this.$http.get("cm/queryGalleryDetail",{gallery_id:this.gallery_id}).then((function(e){t.jurisdiction="CREATOR"==e.result.role||"ADMINISTRATOR"==e.result.role,t.albumInfo=e.result})).catch((function(t){return uni.showToast({title:t.data.errMsg,icon:"none"})}))},onReachBottom:function(){this.queryState&&(this.pageNo+=1,this.queryState=!0,this.queryGalleryItems())},methods:{switchMedia:function(t){this.pageNo=1,"0"===t?(this.mediaStatus="PHOTO",this.photos=[]):(this.mediaStatus="VIDEO",this.videos=[]),this.queryGalleryItems()},filterQuery:function(t){this.tag_def_ids=t.tagDefId,this.pageNo=1,"0"===t.type?(this.mediaStatus="PHOTO",this.photos=[]):(this.mediaStatus="VIDEO",this.videos=[]),this.queryGalleryItems()},moveCheck:function(t){this.allAlbums.forEach((function(e){e.album_id==t.album_id?e.checked=!0:e.checked=!1})),this.$forceUpdate()},closeLabelPanel:function(){this.labelShow=!1},labelFilter:function(t){this.userLebals.forEach((function(e){e.tag_def_id==t.tag_def_id&&(e.check=!e.check)}))},getUserLabels:function(){var t=this;this.$http.get("cm/getUserGalleryTags",{type:"GALLERY",gallery_id:this.gallery_id}).then((function(e){console.log(e),t.userLebals=e.result})).catch((function(t){return uni.showToast({title:t.data.errMsg,icon:"none"})}))},imgPreview:function(t){this.oddGalleryId=t.gallery_id,this.ossobjectId=t.gallery_ossobject_id,this.fileName=t.file_name,this.fileUrl=t.url_original,this.tags=t.tags,this.iscollect=t.is_user_collect,this.$refs.previewImage.previewOpen()},deleteQueryImg:function(){this.pageNo=1,this.photos=[],this.queryGalleryItems()},refreshCollect:function(){this.iscollect=this.iscollect?0:1},moreOpreate:function(t){var e=this;uni.showActionSheet({itemList:["移动至","下载","收藏","删除"],success:function(i){if(0==i.tapIndex)e.movePanel=!0,e.$http.get("pm/queryAlbumsPg",{page_no:1,page_size:100,platform:"WEB"}).then((function(t){e.allAlbums=t.result.albums,e.allAlbums.forEach((function(t){t.checked=!1}))}));else if(1==i.tapIndex){var a=[];e.photos.forEach((function(t){1==t.check&&a.push(t.url_original)})),a.forEach((function(t){uni.saveImageToPhotosAlbum({filePath:t,success:function(t){uni.showToast({title:"下载完成"})}})}))}else if(2==i.tapIndex){var o={is_selected_all:this.selectAllFlag?1:0,platform:"WEB",reason:"ADD_TO_COLLECT",target_album_id:"",target_gallery_id:"",filter_condition:{file_name:"",filter_end_time:15882912e5,filter_start_time:15882048e5,gallery_id:e.gallery_id,object_type:"",order_by_mode:"upload_time",tag_def_ids:0,upload_by:""},gallery_ossobject_ids:t};e.$http.post("cm/advancedOperateGalleryItems",o).then((function(t){uni.showToast({title:"收藏成功"})})),console.log(t)}else 3==i.tapIndex&&e.deleteImages(t)}})},confirmMove:function(t){var e=this,i=this,a=[];i.photos.forEach((function(t){console.log(t),1==t.check&&a.push(t.gallery_ossobject_id)}));this.allAlbums.find((function(t){return 1==t.checked})).album_id;var o={is_selected_all:this.selectAllFlag?1:0,reason:"MOVE_TO_OTHER_GALLERY",platform:"WEB",filter_condition:{file_name:"",filter_end_time:15882912e5,filter_start_time:15882048e5,gallery_id:this.gallery_id,object_type:"",order_by_mode:"upload_time",tag_def_ids:0,upload_by:""},target_tag_def_ids:[],gallery_ossobject_ids:a,target_album_id:"",target_gallery_id:this.gallery_id};this.$http.post("cm/advancedOperateGalleryItems",o).then((function(t){console.log(t),e.movePanel=!1,e.selected_numbers=0,e.photos.forEach((function(t){t.src_1="../../static/albumsDetail/waitphoto.png"})),uni.showToast({title:"移动成功"})})).catch((function(t){return uni.showToast({title:t.data.errMsg,icon:"none"})})),this.$forceUpdate()},deleteImages:function(t){var e=this;uni.showModal({title:"您确定要删除吗",content:"该操作不可撤销",success:function(i){if(i.confirm){var a=(0,o.default)({is_selected_all:this.selectAllFlag?1:0,reason:"DELETE",platform:"WEB",gallery_ossobject_ids:t,filter_condition:{file_name:"",filter_end_time:15882912e5,filter_start_time:15882048e5,gallery_id:e.gallery_id,object_type:"",order_by_mode:"upload_time",tag_def_ids:0,upload_by:""}},"gallery_ossobject_ids",t);e.$http.post("cm/advancedOperateGalleryItems",a).then((function(t){e.page_no=1,e.selected_numbers=0,e.queryGalleryItems()}))}}}),e.$forceUpdate()},icon_choose:function(t){var e=[];e=this.selectAllFlag?this.photos.filter((function(t){return"../../static/albumsDetail/selected.png"!=t.src_1})):this.photos.filter((function(t){return"../../static/albumsDetail/selected.png"==t.src_1})),e=e.map((function(t){return t.gallery_ossobject_id}))},onShareAppMessage:function(t){console.log(t)},m2allAlbums:function(){uni.navigateTo({url:"../allAlbums/allAlbums?galleryId="+this.albumInfo.gallery_id})},mediaSelect:function(t){console.log(t),this.mediaArr.forEach((function(e){e.checked=e.id==t.id})),1==t.id?this.mediaStatus="PHOTO":this.mediaStatus="VIDEO",this.pageNo=1,this.queryGalleryItems()},lastPage:function(){uni.navigateBack({delta:1})},showSelection:function(){this.filtersrc="../../static/albumsDetail/filter.png"==this.filtersrc?"../../static/albumsDetail/filter_1.png":"../../static/albumsDetail/filter.png",this.SelectionStatus=!this.SelectionStatus,this.selectionColor="black"==this.selectionColor?"#FF4E28":"black",this.labelShow=!this.labelShow,this.labelShow&&this.userLebals.forEach((function(t){t.tag_def_id==item.tag_def_id&&(t.bac="rgba(242,242,242,1)"==t.bac?"rgba(255,243,240,1)":"rgba(242,242,242,1)")})),this.getUserLabels()},toggleMulSelect:function(){this.$refs.albumDetail.toggleSelect()},photoSelect:function(){this.photos.forEach((function(t){t.check=!1,t.src_1="../../static/albumsDetail/waitphoto.png"})),this.selectShow=!0,this.status_1=2,this.selected_numbers=0},videoSelect:function(){this.videos.forEach((function(t){t.src_1=t.src_1="../../static/albumsDetail/waitphoto.png"})),this.selectShow=!0,this.status_1=2,this.selected_numbers=0},cancleSelect:function(){this.isAllSelected=!1,this.selectShow=!1,this.photos.forEach((function(t){t.selected=!1,t.src_1=t.src_1="../../static/albumsDetail/waitphoto.png"})),this.selectShow=!1,this.status_1=1,this.selected_numbers=0},queryGalleryItems:function(){var t=this;this.$http.get("cm/queryGalleryItemsPg",{page_no:this.pageNo,page_size:this.pageSize,filter_start_time:this.filter_start_time,filter_end_time:this.filter_end_time,gallery_id:this.gallery_id,order_by_mode:"upload_time",object_type:this.mediaStatus,tag_def_ids:this.tag_def_ids}).then((function(e){e.result.gallery_items.length>0?(1===t.pageNo&&(t.photos=[],t.mediaArr[0].length=e.result.photo_count,t.mediaArr[1].length=e.result.video_count,t.countPhoto=e.result.photo_count,t.countVideo=e.result.video_count),t.photos=t.photos.concat(e.result.gallery_items),t.queryState=!0):t.queryState=!1})).catch((function(t){return console.error(t),uni.showToast({title:t.data.errMsg,icon:"none"})}))},confirmLebals:function(){var t=this,e=[];this.userLebals.forEach((function(t){1==t.check&&e.push(t.tag_def_id)})),0==e.length?(this.$http.get("cm/queryGalleryItemsPg",{page_no:1,page_size:10,filter_start_time:1588032e6,filter_end_time:15881184e5,gallery_id:this.gallery_id,order_by_mode:"upload_time"}).then((function(e){t.photos=[],t.videos=[],e.result.gallery_items.forEach((function(e){"PHOTO"==e.object_type?t.photos.push(e):t.videos.push(e)})),t.mediaArr[0].length=e.result.photo_count,t.mediaArr[1].length=e.result.video_count})).catch((function(t){return uni.showToast({title:t.data.errMsg,icon:"none"})})),this.labelShow=!1):(this.pageNo=1,this.tag_def_ids=JSON.stringify(e),this.queryGalleryItems(),this.tagsPage=1,this.labelShow=!1,this.selectionColor="black",this.filtersrc="../../static/albumsDetail/filter.png")},selectAll:function(){this.selectAllFlag=!this.selectAllFlag,this.selectAllFlag?this.photos.forEach((function(t){t.src_1="../../static/albumsDetail/selected.png"})):this.photos.forEach((function(t){t.src_1="../../static/albumsDetail/waitphoto.png"})),this.$forceUpdate()},selected:function(t){var e=0;this.isAllSelected=!0,"VIDEO"==this.mediaStatus?this.videos.every((function(t){return"../../static/albumsDetail/selected.png"==t.src_1}))?(this.videos.forEach((function(t){t.src_1="../../static/albumsDetail/waitphoto.png"})),e=0):this.videos.forEach((function(t){t.src_1="../../static/albumsDetail/selected.png","../../static/albumsDetail/selected.png"==t.src_1&&e++})):"PHOTO"==this.mediaStatus?this.photos.forEach((function(i){i.gallery_ossobject_id==t&&(i.check=!i.check,i.src_1="../../static/albumsDetail/selected.png"==i.src_1?"../../static/albumsDetail/waitphoto.png":"../../static/albumsDetail/selected.png"),1==i.check&&e++})):"VIDEO"==this.mediaStatus&&this.videos.forEach((function(i){i.gallery_ossobject_id==t&&(i.check=!i.check,i.src_1="../../static/albumsDetail/selected.png"==i.src_1?"../../static/albumsDetail/waitphoto.png":"../../static/albumsDetail/selected.png"),1==i.check&&e++})),this.selected_numbers=e},seeVideo:function(t){console.log(t),this.$refs.videoPlay.init(t)}}};e.default=d},"67e0":function(t,e,i){"use strict";var a=i("0699"),o=i.n(a);o.a},"7d7a":function(t,e,i){"use strict";i.r(e);var a=i("0bd3"),o=i("05fd");for(var l in o)"default"!==l&&function(t){i.d(e,t,(function(){return o[t]}))}(l);i("67e0");var s,n=i("f0c5"),r=Object(n["a"])(o["default"],a["b"],a["c"],!1,null,"9287ddb4",null,!1,a["a"],s);e["default"]=r.exports},a623:function(t,e,i){"use strict";var a=i("23e7"),o=i("b727").every,l=i("a640"),s=i("ae40"),n=l("every"),r=s("every");a({target:"Array",proto:!0,forced:!n||!r},{every:function(t){return o(this,t,arguments.length>1?arguments[1]:void 0)}})}}]);