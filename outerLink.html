<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8"/>
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"/>
    <!--<meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests"/>-->
    <!--<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate"/>-->
    <!--<meta http-equiv="Pragma" content="no-cache"/>-->
    <!--<meta http-equiv="Expires" content="0"/>-->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title></title>
	<style>
		html,body{
			padding:0;
			margin:0;
			width:100%;
			height:100%;
		}
	</style>
</head>
<body>
<div style="width:100%;height:100%;">
	<!-- <iframe id="frame" style="width:100%;height:100%;" src="http://172.16.89.107:8081/m/simpleAlbum?taskId=5c789de22e7b1d2090ee4914&from=singlemessage&isappinstalled=0"></iframe> -->
    <!--<iframe id="frame" style="width:100%;height:100%;" src="./frame.html"></iframe>-->
    <iframe id='frame' src='./imgList.html' style="width:100%;height:100%;"></iframe>
	<img src="" style="opacity: 0.01" id="send"/>
</div>
<script src="zepto.min.js"></script>
<script>
$(document).ready(function(){
	// let frame = document.getElementById('frame');
	// frame.onload = function(){
	//     console.log(document.getElementById('frame').contentWindow.document);
 //        document.getElementById('frame').contentWindow.document.getElementById('frameDiv').addEventListener('touchstart',function (event) {
 //            this.dispatchEvent(event);
 //            frame.dispatchEvent(event);
 //            alert('touch frame');
 //        });
 //    }

 //    IframeOnClick.track(document.getElementById("frame"), function() { console.log('a click'); });
 //    $('#frame').on('touchstart',function(){
	//     console.log('touchstart capture');
	// })
 //    var event = new Event('CustomEvent');
// 监听
    // elem.addEventListener('CustomEvent', function (e) { ... }, false);
// 触发event
    // elem.dispatchEvent(event);
});
function print(){
    console.log('print log');
}
function sendImg(src){
    console.log('receive data');
    console.log($('#send'));
    $('#send').attr('src',src);
    $('#send').trigger('touchstart');
}
var IframeOnClick = {
    resolution: 200,
    iframes: [],
    interval: null,
    Iframe: function() {
        this.element = arguments[0];
        this.cb = arguments[1];
        this.hasTracked = false;
    },
    track: function(element, cb) {
        this.iframes.push(new this.Iframe(element, cb));
        if (!this.interval) {
            var _this = this;
            this.interval = setInterval(function() { _this.checkClick(); }, this.resolution);
        }
    },
    checkClick: function() {
        if (document.activeElement) {
            var activeElement = document.activeElement;
            for (var i in this.iframes) {
                if (activeElement === this.iframes[i].element) { // user is in this Iframe
                    if (this.iframes[i].hasTracked == false) {
                        this.iframes[i].cb.apply(window, []);
                        this.iframes[i].hasTracked = true;
                    }
                } else {
                    this.iframes[i].hasTracked = false;
                }
            }
        }
    }
};
</script>
</body>
</html>